<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>è¨ºæ–­çµæœï½œã‚®ã‚¿ãƒ¼å ã„</title>

  <!-- CSSï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°ã®ãŸã‚ v=9 ã«ï¼‰ -->
  <link rel="stylesheet" href="style.css?v=9" />

  <!-- OGPï¼ˆä»»æ„ï¼‰ -->
  <meta property="og:title" content="ã‚®ã‚¿ãƒ¼å ã„ï½œè¨ºæ–­çµæœ">
  <meta property="og:description" content="ã‚ãªãŸã®ã‚®ã‚¿ãƒ¼æ°—è³ªã¯â€¦ï¼Ÿ">
  <meta property="og:image" content="og.jpg">
  <meta name="twitter:card" content="summary_large_image">
</head>
<body>
  <header class="hero">
    <h1>ã‚®ã‚¿ãƒ¼å ã„ï½œè¨ºæ–­çµæœ</h1>
    <p class="subtitle">ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ä¸€æœ¬ã¯â€¦ï¼ŸğŸ¸</p>
  </header>

  <div id="result">èª­ã¿è¾¼ã¿ä¸­â€¦</div>

  <div class="actions" style="max-width:860px;margin:12px auto 0;text-align:center;">
    <a href="./" class="btn" rel="noopener">ğŸ” ã‚‚ã†ä¸€åº¦è¨ºæ–­</a>
    <a id="shareX" target="_blank" class="btn" rel="noopener">ğŸ•Šï¸ Xã§ã‚·ã‚§ã‚¢</a>
    <button id="copyLink" class="btn">ğŸ”— ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼</button>
  </div>

  <script>
  (function () {
    // ã‚¯ã‚¨ãƒªå–å¾—
    const key = new URLSearchParams(location.search).get("t");

    // ã‚¿ã‚¤ãƒ—è¾æ›¸ï¼ˆ12ï¼‹éš ã—4ï¼‹è£œåŠ©flyingvï¼‰
    const MAP = {
      strat:{ title:"Fender Stratocaster",  desc:"ãƒãƒ©ãƒ³ã‚¹è‰¯ãç¤¾äº¤çš„ã€‚å¯¾å¿œåŠ›ãŒé«˜ãã€ã©ã‚“ãªå ´ã§ã‚‚è‡ªåˆ†ã®è‰²ã‚’å‡ºã›ã‚‹ã€‚", icon:"ğŸ¸" },
      tele:{ title:"Fender Telecaster",    desc:"èª å®Ÿã§å®Ÿç›´ã€‚èŠ¯ã®å¼·ã•ã¨ç´ æœ´ãªé­…åŠ›ã§ä¿¡é ¼ã‚’é›†ã‚ã‚‹ã€‚", icon:"â­" },
      lespaul:{ title:"Gibson Les Paul",    desc:"å­˜åœ¨æ„Ÿã¨èª¬å¾—åŠ›ã€‚åšã¿ã®ã‚ã‚‹è¨€è‘‰ã¨è¡Œå‹•ã§å‘¨å›²ã‚’å¼•ã£å¼µã‚‹ã€‚", icon:"ğŸ”¥" },
      es335:{ title:"Gibson ES-335",        desc:"ä½™è£•ã¨æ°—å“ã€‚è½ã¡ç€ãã¨æŸ”ã‚‰ã‹ã•ã®ä¸¡ç«‹ã§å ´ã‚’ã¾ã¨ã‚ã‚‹ã€‚", icon:"ğŸ¶" },
      ricken:{ title:"Rickenbacker",         desc:"ã‚»ãƒ³ã‚¹æ´¾ã€‚ç‹¬è‡ªã®ã“ã ã‚ã‚Šã¨ã‚­ãƒ©ãƒªã¨å…‰ã‚‹å€‹æ€§ã§é­…äº†ã™ã‚‹ã€‚", icon:"âœ¨" },
      ibanez:{ title:"Ibanez",               desc:"å…ˆé‹­ãƒ»ãƒ†ã‚¯å¿—å‘ã€‚æ–°ã—ã„æŒ‘æˆ¦ã‚’æ¥½ã—ã‚€é–‹æ‹“ã‚¿ã‚¤ãƒ—ã€‚", icon:"âš¡" },
      jazzmaster:{ title:"Fender Jazzmaster",desc:"ã‚ªãƒ«ã‚¿ãƒŠç³»ã€‚ã²ã¨å‘³é•ã†ç™ºæƒ³ã§å‰µé€ æ€§ã‚’ç™ºæ®ã€‚", icon:"ğŸŒŠ" },
      prs:{ title:"PRS Custom 24",           desc:"é«˜å“ä½ãƒ»ä¸‡èƒ½å‹ã€‚ä»•ä¸Šã’é‡è¦–ã§å®Œæˆåº¦ã‚’é«˜ã‚ã‚‹è·äººè‚Œã€‚", icon:"ğŸ’" },
      sg:{ title:"Gibson SG",                desc:"ç›´çƒå‹è² ã€‚ã‚¹ãƒ”ãƒ¼ãƒ‰æ„Ÿã¨ç†±é‡ã§å‘¨å›²ã‚’å·»ãè¾¼ã‚€ã€‚", icon:"ğŸš€" },
      dane:{ title:"Danelectro",             desc:"è»½å¿«ã§éŠã³å¿ƒã€‚ç™ºæƒ³ãŒæŸ”ã‚‰ã‹ãã€ãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼ã€‚", icon:"ğŸ­" },
      mustang:{ title:"Fender Mustang",      desc:"èº«è»½ãªãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼ã€‚å°å›ã‚Šã¨ç¬ç™ºåŠ›ãŒæ­¦å™¨ã€‚", icon:"ğŸƒ" },
      pacifica:{ title:"Yamaha Pacifica",    desc:"ãƒãƒ©ãƒ³ã‚¹å‹ã€‚å®Ÿç”¨æ€§ã¨å®‰å®šæ„Ÿã§æˆæœã‚’å‡ºã™å …å®Ÿæ´¾ã€‚", icon:"ğŸ§©" },
      // éš ã—ã‚­ãƒ£ãƒ©
      casino:{ title:"Epiphone Casino",      desc:"é­…äº†ã¨å¤šé¢æ€§ã€‚äººã‚’æƒ¹ãã¤ã‘ã‚‹äº¤æ¸‰ä¸Šæ‰‹ã€‚", icon:"ğŸ°" },
      yamahasg:{ title:"Yamaha SG",          desc:"é‡åšã§å …å®Ÿã€‚è…°ã®æ®ã‚ã£ãŸå®‰å®šã®è»¸ã€‚", icon:"ğŸ›¡ï¸" },
      lpjr:{ title:"Gibson Les Paul Junior", desc:"æœ€å°é™ã§æœ€å¤§ã€‚æœ¬è³ªã‚’çªããƒŸãƒ‹ãƒãƒªã‚¹ãƒˆã€‚", icon:"ğŸ”§" },
      explorer:{ title:"Gibson Explorer",    desc:"é–‹æ‹“ç²¾ç¥ã€‚æœªçŸ¥ã‚’åˆ‡ã‚Šé–‹ããƒ‘ã‚¤ã‚ªãƒ‹ã‚¢ã€‚", icon:"ğŸ§­" },
      // å˜ç‹¬ãƒˆãƒƒãƒ—ä¿é™º
      flyingv:{ title:"Gibson Flying V",     desc:"å‹¢ã„ã‚ˆãå‰ã¸ã€‚å‹ã«ã¨ã‚‰ã‚ã‚Œãšé“ã‚’åˆ‡ã‚Šé–‹ãæŒ‘æˆ¦è€…ã€‚", icon:"âš¡" },
    };

    const $res = document.getElementById("result");

    try {
      // ã‚¯ã‚¨ãƒªãŒãªã„ï¼æœªçŸ¥ã‚­ãƒ¼ã®ã¨ãã¯ä¸å¯§ã«æ¡ˆå†…ï¼ˆçœŸã£ç™½å›é¿ï¼‰
      if (!key || !MAP[key]) {
        $res.innerHTML = `
          <span class="result-badge">ãŠçŸ¥ã‚‰ã›</span>
          çµæœã‚­ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚<br>
          <a href="./" class="btn" style="margin-top:10px">ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹</a>
        `;
        return;
      }

      const data = MAP[key];
      document.title = `è¨ºæ–­çµæœï½œ${data.title}ï½œã‚®ã‚¿ãƒ¼å ã„`;

      // çµæœæç”»
      $res.innerHTML = `
        <span class="result-badge">è¨ºæ–­çµæœ</span>
        <strong>${data.icon || "ğŸ¸"} ${data.title}</strong> â€” ${data.desc}
      `;
      requestAnimationFrame(() => $res.classList.add('show'));

      // å…±æœ‰ï¼†ã‚³ãƒ”ãƒ¼ï¼ˆãƒˆãƒƒãƒ—URLã‚’å…±æœ‰ï¼‰
      const shareUrl = location.origin + location.pathname.replace(/result\.html$/,'');
      const shareText = `ç§ã¯ã€${data.title}ã€ã‚¿ã‚¤ãƒ—ã§ã—ãŸï¼ #ã‚®ã‚¿ãƒ¼å ã„`;
      const share = document.getElementById("shareX");
      if (share) share.href =
        `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}`;

      const copyBtn = document.getElementById('copyLink');
      if (copyBtn){
        copyBtn.addEventListener('click', async () => {
          try{
            await navigator.clipboard.writeText(shareUrl);
            const old = copyBtn.textContent;
            copyBtn.textContent = 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
            setTimeout(()=> copyBtn.textContent = old, 1600);
          }catch(e){ alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ'); }
        });
      }
    } catch (err) {
      // ä½•ã‹ã‚ã£ã¦ã‚‚çœŸã£ç™½ã«ã—ãªã„
      console.error(err);
      $res.innerHTML = `
        <span class="result-badge">ã‚¨ãƒ©ãƒ¼</span>
        äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚<br>
        <small style="opacity:.8">è©³ç´°: ${String(err.message || err)}</small><br>
        <a href="./" class="btn" style="margin-top:10px">ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹</a>
      `;
    }
  })();
  </script>
<script type="module">
  import { GUITARS } from "./data/guitarTypes.js";

  // --- ã‚¿ã‚¤ãƒ—åã‚’æ­£è¦åŒ–ã—ã¦æºã‚Œã‚’å¸å ---
  function normalize(raw){
    let s = (raw || "").toLowerCase().trim();

    // æ—©æœŸãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆãƒ–ãƒ©ãƒ³ãƒ‰ä»˜ããƒ»ç•¥ç§°å¯¾å¿œï¼‰
    const quick = s.replace(/\s+/g,"");
    const quickMap = {
      "es335": "es-335",
      "flyingv": "flying-v",
      "prscustom24": "prs-custom-24",
      "yamahapacifica": "yamaha-pacifica",
      "yamahasg": "yamaha-sg",
      "yamaha sg": "yamaha-sg",
      "lespauljr": "les-paul-junior",
      "lespauljunior": "les-paul-junior",
      "les paul jr": "les-paul-junior",
      "les paul junior": "les-paul-junior",
    };
    if (quickMap[quick]) return quickMap[quick];

    // ãƒ–ãƒ©ãƒ³ãƒ‰åã‚’å…ˆé ­ã‹ã‚‰é™¤å»ï¼ˆãŸã ã—Yamaha SGã¯quickMapã§å…ˆã«ä¿è­·æ¸ˆã¿ï¼‰
    s = s.replace(/^(fender|gibson|epiphone|prs|yamaha)/, "");
    s = s.replace(/\s+/g,""); // ã‚¹ãƒšãƒ¼ã‚¹é™¤å»

    // ã‚†ã‚Œå¯¾å¿œ
    const map = {
      "lespaul": "les-paul",
      "es335": "es-335",
      "prscustom24": "prs-custom-24",
      "flyingv": "flying-v",
      "yamahapacifica": "yamaha-pacifica",
      "casino": "casino",
      "explorer": "explorer",
      "rickenbacker": "rickenbacker",
      "telecaster": "telecaster",
      "stratocaster": "stratocaster",
      "jazzmaster": "jazzmaster",
      "ibanez": "ibanez",
      "sg": "sg",
      "danelectro": "danelectro",
      "mustang": "mustang",
      "pacifica": "yamaha-pacifica" // ä¿—ç§°
    };
    return map[s] || s;
  }

  // --- ã‚­ãƒ¼ã‚’æ±ºå®šã™ã‚‹ ---
  function getKey(){
    const params = new URLSearchParams(location.search);
    let key = normalize(params.get("type"));

    // localStorage fallback
    if(!key){
      try{
        const saved = JSON.parse(localStorage.getItem("guitar_diagnosis")||"{}");
        if (saved.resultKey) key = normalize(saved.resultKey);
      }catch(_){}
    }

    // ãƒšãƒ¼ã‚¸ä¸Šã®è¨ºæ–­çµæœåã‹ã‚‰æ‹¾ã†ï¼ˆ#resultName ãŒã‚ã‚Œã°ãƒ™ã‚¹ãƒˆï¼‰
    if(!key){
      const nameEl =
        document.querySelector("#resultName") ||
        document.querySelector(".result-name, .resultTitle, .badge, .pill, h2, h3");
      if(nameEl && nameEl.textContent){
        key = normalize(nameEl.textContent);
      }
    }

    if(!GUITARS[key]) key = "stratocaster"; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
    return key;
  }

  const key = getKey();
  const d = GUITARS[key];

  // --- ã‚¹ã‚¿ã‚¤ãƒ«æ³¨å…¥ ---
  const style = document.createElement("style");
  style.textContent = `
    .g-detail-card{max-width:1000px;margin:24px auto;padding:20px;border-radius:16px;
      background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.12)}
    .g-hero{display:grid;grid-template-columns:1.2fr 1fr;gap:16px;align-items:stretch}
    .g-img{width:100%;height:100%;object-fit:contain;background:rgba(255,255,255,0.04);border-radius:12px}
    .g-info h2{margin:.2rem 0;font-size:1.6rem;font-weight:800}
    .g-tag{display:inline-block;margin-bottom:.5rem;padding:.25rem .6rem;border-radius:999px;
      font-size:.8rem;background:rgba(147,197,253,.15);border:1px solid rgba(147,197,253,.35)}
    .g-tagline{opacity:.85;margin:.25rem 0 1rem}
    .g-persona{opacity:.9}
    .g-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
    .g-sec{padding:12px;border-radius:12px;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.08)}
    .g-sec h3{margin:.2rem 0 .4rem;font-size:1rem;opacity:.9}
    .g-sec ul{margin:.2rem 0 .4rem 1.2rem}
    @media (max-width:860px){.g-hero{grid-template-columns:1fr}}
  `;
  document.head.appendChild(style);

  // --- ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¦ãƒšãƒ¼ã‚¸æœ«å°¾ã«è¿½åŠ  ---
  const host = document.querySelector("main") || document.querySelector("#app") || document.body;
  const card = document.createElement("section");
  card.className = "g-detail-card";
  card.innerHTML = `
    <div class="g-hero">
      <img class="g-img" src="${d.image}" alt="${d.name}">
      <div class="g-info">
        <span class="g-tag">GUITAR TYPE</span>
        <h2>${d.name}</h2>
        <p class="g-tagline">${d.tagline}</p>
        <p class="g-persona">${d.persona}</p>
        <div class="g-grid">
          <div class="g-sec">
            <h3>å¼·ã¿</h3>
            <ul>${d.strengths.map(s=>`<li>${s}</li>`).join("")}</ul>
          </div>
          <div class="g-sec">
            <h3>æ°—ã‚’ã¤ã‘ãŸã„ç‚¹</h3>
            <ul>${d.caution.map(s=>`<li>${s}</li>`).join("")}</ul>
          </div>
        </div>
        <div class="g-sec"><h3>ã‚¢ãƒ‰ãƒã‚¤ã‚¹ï¼ˆä»•äº‹/æ‹æ„›ï¼‰</h3><p>${d.loveWorkTips}</p></div>
        <div class="g-sec"><h3>ç›¸æ€§ãŒè‰¯ã„ã‚¿ã‚¤ãƒ—</h3><p>${d.matches.join(" / ")}</p></div>
      </div>
    </div>
  `;
  host.appendChild(card);
</script>
</body>
</html>
